# タスク

`#exportExcelBtn` をクリックしたらローディング画面を表示するタスクです。
チェックリストを作成したりタスクが増えたら、ユーザーの指示がなくても編集してください。
チェックリストのタスクが完了したらユーザーの指示がなくても編集してください。

## やりたいこと

- `#exportExcelBtn` をクリックしたらローディング画面を表示する

## 現時点で考えている実装方法

- `#exportExcelBtn` をクリックしたら `#loadingOverlay` の `hidden` を除外する

## チェックリスト

`A: `のようにアルファベットのラベルをつけることで、参照しやすくする

### 1. タスク分解

- [x] A: タスク分解して2以降のチェックリストを書き換える。もし、「現時点で考えている実装方法」の方法が不適切ならば、適切な実装方法を提案してください。

### 2. 実装

- [x] B: handleExportExcel()メソッドの開始時にstartLoading('Excelファイル作成中')を追加
- [x] C: handleExportExcel()メソッドの終了時（成功・失敗両方）にfinishLoading()を追加

### 3. テスト

- [x] D: 実装をテストして動作確認

## 実装詳細

handleExportExcel()メソッドに以下の変更を行いました：
1. メソッド開始時に`this.startLoading('Excelファイル作成中')`を追加
2. ローディング画面を確実に表示するため、100ms の待機時間を追加
3. try-catch-finallyブロックでエラーハンドリングを追加
4. finallyブロックで`this.finishLoading()`を呼び出し、成功・失敗に関わらずローディング画面を非表示にする 

